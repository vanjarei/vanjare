<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>T-Shirt Order System</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f4f4f9;
    }
    h1, h2 {
      text-align: center;
      color: #333;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    label {
      font-weight: bold;
    }
    input, select, button {
      padding: 10px;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: center;
    }
    th {
      background-color: #f8f9fa;
    }
    .summary {
      margin-top: 20px;
    }
    .total-count {
      font-weight: bold;
      font-size: 1.2rem;
      margin-bottom: 10px;
    }
    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>T-Shirt Order System</h1>

  <!-- Form for Party Details -->
  <div class="container">
    <h2>Party Details</h2>
    <form id="partyDetailsForm">
      <label for="partyName">Party Name:</label>
      <input type="text" id="partyName" placeholder="Enter party name" required>

      <label for="deliveryDate">Delivery Date:</label>
      <input type="date" id="deliveryDate" required>

      <button type="submit">Save Party Details</button>
    </form>
  </div>

  <!-- Form for T-Shirt Details -->
  <div class="container">
    <h2>T-Shirt Details</h2>
    <form id="tShirtForm">
      <label for="playerName">Player Name:</label>
      <input type="text" id="playerName" placeholder="Enter Player Name" required>

      <label for="tNo">T-No:</label>
      <input type="text" id="tNo" placeholder="Enter T-No" required>

      <label for="tShirtSize">T-Shirt Size:</label>
      <input type="number" id="tShirtSize" placeholder="Enter Size (e.g., 38)" required>

      <label for="sleeveType">Sleeve Type:</label>
      <select id="sleeveType" required>
        <option value="" disabled selected>Select Sleeve Type</option>
        <option value="Full Sleeve">Full Sleeve</option>
        <option value="Half Sleeve">Half Sleeve</option>
      </select>

      <button type="submit">Add Entry</button>
    </form>
  </div>

  <!-- Summary Section -->
  <div class="container">
    <h2>Summary</h2>
    <div id="partyDetailsDisplay"></div>

    <div class="summary">
      <div class="total-count">Total T-Shirts: 0</div>
      <div class="total-sleeves">Total Half Sleeve: 0 | Total Full Sleeve: 0</div>

      <table id="summaryTable">
        <thead>
          <tr>
            <th>Sr. No</th>
            <th>Player Name</th>
            <th>T-No</th>
            <th>Size</th>
            <th>Sleeve Type</th>
          </tr>
        </thead>
        <tbody>
          <!-- Entries will be dynamically added here -->
        </tbody>
      </table>
    </div>

    <div class="action-buttons">
      <button id="downloadExcel">Download Excel</button>
    </div>
  </div>

  <script>
    const partyDetailsForm = document.getElementById("partyDetailsForm");
    const tShirtForm = document.getElementById("tShirtForm");
    const totalCountDisplay = document.querySelector(".total-count");
    const totalSleevesDisplay = document.querySelector(".total-sleeves");
    const summaryTable = document.getElementById("summaryTable").querySelector("tbody");
    const partyDetailsDisplay = document.getElementById("partyDetailsDisplay");
    const downloadExcelButton = document.getElementById("downloadExcel");

    let tShirtEntries = [];
    let totalHalfSleeves = 0;
    let totalFullSleeves = 0;
    let totalTShirts = 0;

    let partyDetails = {
      name: "",
      date: ""
    };

    // Save Party Details
    partyDetailsForm.addEventListener("submit", (event) => {
      event.preventDefault();
      partyDetails.name = document.getElementById("partyName").value.trim();
      partyDetails.date = document.getElementById("deliveryDate").value;

      partyDetailsDisplay.innerHTML = `
        <p><strong>Party Name:</strong> ${partyDetails.name}</p>
        <p><strong>Delivery Date:</strong> ${partyDetails.date}</p>
      `;

      partyDetailsForm.reset();
    });

    // Add T-Shirt Entry
    tShirtForm.addEventListener("submit", (event) => {
      event.preventDefault();
      const playerName = document.getElementById("playerName").value.trim();
      const tNo = document.getElementById("tNo").value.trim();
      const size = document.getElementById("tShirtSize").value.trim();
      const sleeveType = document.getElementById("sleeveType").value;

      tShirtEntries.push({ playerName, tNo, size, sleeveType });
      totalTShirts++;
      if (sleeveType === "Half Sleeve") totalHalfSleeves++;
      else if (sleeveType === "Full Sleeve") totalFullSleeves++;

      updateSummary();
      tShirtForm.reset();
    });

    // Update Summary Table
    function updateSummary() {
      summaryTable.innerHTML = tShirtEntries
        .map((entry, index) => `
          <tr>
            <td>${index + 1}</td>
            <td>${entry.playerName}</td>
            <td>${entry.tNo}</td>
            <td>${entry.size}</td>
            <td>${entry.sleeveType}</td>
          </tr>
        `)
        .join("");

      totalCountDisplay.textContent = `Total T-Shirts: ${totalTShirts}`;
      totalSleevesDisplay.textContent = `Total Half Sleeve: ${totalHalfSleeves} | Total Full Sleeve: ${totalFullSleeves}`;
    }

    // Download Excel File
    downloadExcelButton.addEventListener("click", () => {
      const worksheet = XLSX.utils.json_to_sheet(
        tShirtEntries.map((entry, index) => ({
          "Sr. No": index + 1,
          "Player Name": entry.playerName,
          "T-No": entry.tNo,
          "Size": entry.size,
          "Sleeve Type": entry.sleeveType
        }))
      );

      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "T-Shirt Orders");
      XLSX.writeFile(workbook, "T-Shirt_Orders.xlsx");
    });
  </script>
</body>
        </html>
        
